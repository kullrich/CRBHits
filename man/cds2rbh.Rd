% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cds2rbh.R
\name{cds2rbh}
\alias{cds2rbh}
\title{cds2rbh}
\usage{
cds2rbh(
  cds1,
  cds2,
  lastpath = paste0(find.package("CRBHits"), "/extdata/last-1080/src/"),
  outpath = "/tmp",
  crbh = TRUE,
  keepSingleDirection = FALSE,
  evalue = 0.001,
  qcov = 0,
  tcov = 0,
  pident = 0,
  alnlen = 0,
  rost1999 = FALSE,
  filter = NULL,
  plotCurve = FALSE,
  fit.type = "mean",
  fit.varweight = 0.1,
  fit.min = 5,
  threads = 1,
  remove = TRUE
)
}
\arguments{
\item{cds1}{cds1 sequences as \code{DNAStringSet} [mandatory]}

\item{cds2}{cds2 sequences as \code{DNAStringSet} [mandatory]}

\item{lastpath}{specify the PATH to the last binaries [default: /extdata/last-1080/src/]}

\item{outpath}{specify the output PATH [default: /tmp]}

\item{crbh}{specify if conditional-reciprocal hit pairs should be retained as secondary hits [default: TRUE]}

\item{keepSingleDirection}{specify if single direction secondary hit pairs should be retained [default: FALSE]}

\item{evalue}{evalue [default: 1e-3]}

\item{qcov}{query coverage [default: 0.0]}

\item{tcov}{target coverage [default: 0.0]}

\item{pident}{percent identity [default: 0.0]}

\item{alnlen}{alignment length [default: 0.0]}

\item{rost1999}{specifiy if hit pairs should be filter by equation 2 of Rost 1999 [default: FALSE]}

\item{filter}{specify additonal custom filters as list to be applied on hit pairs [default: NULL]}

\item{plotCurve}{specify if crbh fitting curve should be plotted [default: FALSE]}

\item{fit.type}{specify if mean or median should be used for fitting [default: mean]}

\item{fit.varweight}{factor for fitting function to consider neighborhood [default: 0.1]}

\item{fit.min}{specify minimum neighborhood alignment length [default: 5]}

\item{threads}{number of parallel threads [default: 1]}

\item{remove}{specify if last result files should be removed [default: TRUE]}
}
\value{
List of three (crbh = FALSE)\cr
1: $rbh.pairs\cr
2: $rbh1 matrix; query > target\cr
3: $rbh2 matrix; target > query\cr
\cr
List of four (crbh = TRUE)\cr
1: $crbh.pairs\cr
2: $crbh1 matrix; query > target\cr
3: $crbh2 matrix; target > query\cr
4: $rbh1_rbh2_fit; evalue fitting function
}
\description{
This function calculates (conditional-)reciprocal best hit pair matrix from two \code{DNAStringSet}'s.
Conditional-reciprocal best hit pairs were introduced by \emph{Aubry S, Kelly S et al. (2014)}.
Sequence searches are performed with \bold{last} \emph{Kiełbasa, SM et al. (2011)}.
If one specifies cds1 and cds2 as the same input a selfblast is conducted.
}
\examples{
##compile last-1080 within CRBHits
make.last()
##load example sequence data
data("ath", package="CRBHits")
data("aly", package="CRBHits")
#conditional-reciprocal best hits
ath_aly_crbh <- cds2rbh(ath, aly, plotCurve = TRUE)
dim(ath_aly_crbh$crbh.pairs)
#reciprocal best hits
ath_aly_rbh <- cds2rbh(ath, aly, crbh = FALSE)
dim(ath_aly_rbh$rbh.pairs)
#filter for evalue 1e-100
ath_aly_crbh.eval100 <- cds2rbh(ath, aly, evalue = 1e-100)
dim(ath_aly_crbh.eval100$crbh.pairs)
#filter for query coverage
ath_aly_crbh.qcov <- cds2rbh(ath, aly, qcov = 0.5)
dim(ath_aly_crbh.qcov$crbh.pairs)
#custom filter for e.g. bit score (column 12)
myfilter <- function(rbh, value = 500.0){
return(rbh[as.numeric(rbh[, 12]) >= value , , drop = FALSE])
}
ath_aly_crbh.custom <- cds2rbh(ath, aly, filter = list(myfilter))
dim(ath_aly_crbh.custom$crbh.pairs)
#multiple filters can be given in filter param as list
#
#selfblast
ath_selfblast_crbh <- cds2rbh(ath, ath, plotCurve = TRUE)
}
\references{
Aubry S, Kelly S et al. (2014) Deep Evolutionary Comparison of Gene Expression Identifies Parallel Recruitment of Trans-Factors in Two Independent Origins of C4 Photosynthesis. \emph{PLOS Genetics}, \bold{10(6)} e1004365.

Kiełbasa, SM et al. (2011) Adaptive seeds tame genomic sequence comparison. \emph{Genome research}, \bold{21(3)}, 487-493.

Rost B. (1999). Twilight zone of protein sequence alignments. \emph{Protein Engineering}, \bold{12(2)}, 85-94.
}
\seealso{
\code{\link[CRBHits]{cdsfile2rbh}}
}
\author{
Kristian K Ullrich
}
