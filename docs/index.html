<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>What the Package Does (One Line, Title Case) • CRBHits</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="What the Package Does (One Line, Title Case)">
<meta property="og:description" content="What the package does (one paragraph).">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">CRBHits</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/CRBHitsVignette.html">CRBHits Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="crbhits---conditional-reciprocal-best-hit-in-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#crbhits---conditional-reciprocal-best-hit-in-r" class="anchor"></a>CRBHits - Conditional Reciprocal Best Hit in R</h1></div>
</div>
<div id="crbhits---description" class="section level1">
<h1 class="hasAnchor">
<a href="#crbhits---description" class="anchor"></a>CRBHits - Description</h1>
<p><a href="https://github.com/kullrich/CRBHits">CRBHits</a> is a reimplementation of the Conditional Reciprocal Best Hit algorithm <a href="https://github.com/cboursnell/crb-blast">crb-blast</a> in R.</p>
<p>The algorithm was introduced by <a href="http://www.plosgenetics.org/article/info%3Adoi%2F10.1371%2Fjournal.pgen.1004365">Aubry S, Kelly S et al 2014</a> and ported to python (<a href="https://pypi.org/project/shmlast/">shmlast</a>) by <a href="https://joss.theoj.org/papers/10.21105/joss.00142">Scott C 2017</a> which benefits from an alternative blast software, namely <a href="http://last.cbrc.jp/">LAST</a> (<a href="https://genome.cshlp.org/content/21/3/487.long">Kiełbasa SM et al 2011</a>).</p>
<p>Like <a href="https://pypi.org/project/shmlast/">shmlast</a>, <a href="https://github.com/kullrich/CRBHits">CRBHits</a> plots the fitted model of the conditional reciprocal best hit evalue based algorithm. In addition users can filter the hit pairs prior fitting for other cirteria like evalue, protein identity and/or the twilight zone of protein sequence alignments according to <a href="https://academic.oup.com/peds/article/12/2/85/1550637">Rost 1999</a>.</p>
<p><a href="https://github.com/kullrich/CRBHits">CRBHits</a> only takes coding nucleotide sequences as the query and target inputs, since the primary aim of CRBHits is to calculate synonymous and non-synonymous substitutions with the R-package <a href="https://cran.r-project.org/web/packages/seqinr/index.html">seqinr</a> (<a href="https://link.springer.com/chapter/10.1007/978-3-540-35306-5_10">Sharif D, Lobry JR 2007</a>) or the external tool <a href="https://sourceforge.net/projects/kakscalculator2/files/KaKs_Calculator2.0.tar.gz/download">KaKs_Calculator2.0</a> (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5054116/">Wang D, Zhang Y et al 2010</a>). This is in contrast to <a href="https://github.com/cboursnell/crb-blast">crb-blast</a>, which can take proteins or nucleotides as the target sequences and in contrast to <a href="https://pypi.org/project/shmlast/">shmlast</a>, which</p>
</div>
<div id="installation" class="section level1">
<h1 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h1>
<div id="r-specific-installation-prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#r-specific-installation-prerequisites" class="anchor"></a>R specific installation prerequisites</h2>
<div id="install-packages-from-cran-cran-" class="section level3">
<h3 class="hasAnchor">
<a href="#install-packages-from-cran-cran-" class="anchor"></a>install packages from cran <a href="https://cran.r-project.org/web/packages/index.html">CRAN</a>.</h3>
<p>In most cases you need to first install the following system-wide packages to be able to compile the R dependencies.</p>
<p>Ubuntu/Debian</p>
<pre><code>sudo apt-get install libcurl4-openssl-dev libssl-dev libxml2-dev</code></pre>
<p>CentOS</p>
<pre><code>sudo yum install libcurl-devel openssl-devel libxml2-devel</code></pre>
<ul>
<li><a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a></li>
<li><a href="https://cran.r-project.org/web/packages/seqinr/index.html">seqinr</a></li>
<li><a href="https://cran.r-project.org/web/packages/foreach/index.html">foreach</a></li>
<li><a href="https://cran.r-project.org/web/packages/doMC/index.html">doMC</a></li>
<li><a href="https://cran.r-project.org/web/packages/magrittr/index.html">magrittr</a></li>
</ul>
<pre><code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("devtools")
install.packages("seqinr")
install.packages("foreach")
install.packages("doMC")
install.packages("magrittr")</a></code></pre>
</div>
<div id="install-packages-from-bioconductor-bioconductor-" class="section level3">
<h3 class="hasAnchor">
<a href="#install-packages-from-bioconductor-bioconductor-" class="anchor"></a>install packages from Bioconductor <a href="https://www.bioconductor.org/">Bioconductor</a>.</h3>
<pre><code>if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")

BiocManager::install("Biostrings")</code></pre>
</div>
<div id="install-crbhits" class="section level3">
<h3 class="hasAnchor">
<a href="#install-crbhits" class="anchor"></a>install <a href="https://github.com/kullrich/CRBHits">CRBHits</a>
</h3>
<pre><code><a href="https://devtools.r-lib.org//reference">library(devtools)
install_github("kullrich/CRBHits", build_vignettes = TRUE, dependencies = FALSE)
install_git("https://gitlab.gwdg.de/mpievolbio-it/crbhits/crbhits.git", build_vignettes = TRUE, dependencies = FALSE)</a></code></pre>
</div>
</div>
<div id="external-tools-installation-prerequisites" class="section level2">
<h2 class="hasAnchor">
<a href="#external-tools-installation-prerequisites" class="anchor"></a>External tools installation prerequisites</h2>
<p>The source code for both prerequisites (LAST, KaKs_Calculator2.0) are forked within <a href="">CRBHits</a>.</p>
<ul>
<li><a href="http://last.cbrc.jp/">LAST</a></li>
</ul>
<pre><code><a href="https://rdrr.io/r/base/getwd.html">#system("wget -O http://last.cbrc.jp/last-1060.zip -P ", paste0(find.package(CRBH), "/extdata/"))
setwd(paste0(find.package("CRBHits"), "/extdata/"))
system(paste0("unzip last-1060.zip"))
setwd(paste0(find.package("CRBHits"), "/extdata/last-1060/"))
# see more installation iformation here, if make fails
# last-install-help: http://last.cbrc.jp/doc/last.html
system("make")</a></code></pre>
<ul>
<li><a href="https://sourceforge.net/projects/kakscalculator2/files/KaKs_Calculator2.0.tar.gz/download">KaKs_Calculator2.0</a></li>
</ul>
<pre><code><a href="https://rdrr.io/r/base/getwd.html">setwd(paste0(find.package("CRBHits"), "/extdata/"))
system(paste0("tar -xvf KaKs_Calculator2.0.tar.gz"))
setwd(paste0(find.package("CRBHits"), "/extdata/KaKs_Calculator2.0/src/"))
system("make clean")
system("make")</a></code></pre>
<p>If you would like to install the latest version of both tools, you need to download the source code and compile again.</p>
</div>
<div id="vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#vignettes" class="anchor"></a>Vignettes</h2>
<p>These vignettes introduce <code>CRBHits</code></p>
<ul>
<li><a href="https://github.com/kullrich/CRBHits/tree/master/vignettes/CRBHitsVignette.Rmd">CRBHits Vignette</a></li>
</ul>
</div>
<div id="quick-guide" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-guide" class="anchor"></a>Quick-guide</h2>
<pre><code><a href="https://rdrr.io/pkg/CRBHits/man">library(CRBHits)
#conditional-reciprocal best hits
data("ath", package="CRBHits")
data("aly", package="CRBHits")
ath_aly_crbh &lt;- cds2rbh(ath, aly, plotCurve = TRUE)

#kaks calculation
ath_aly_crbh.kaks &lt;- rbh2kaks(ath, aly, ath_aly_crbh)

#kaks calculation using multiple threads
ath_aly_crbh.kaks &lt;- rbh2kaks(ath, aly, ath_aly_crbh, threads = 4)</a></code></pre>
</div>
<div id="todo" class="section level2">
<h2 class="hasAnchor">
<a href="#todo" class="anchor"></a>## Todo</h2>
</div>
<div id="license" class="section level2">
<h2 class="hasAnchor">
<a href="#license" class="anchor"></a>License</h2>
<p>MIT (see LICENSE)</p>
</div>
<div id="bug-reports" class="section level2">
<h2 class="hasAnchor">
<a href="#bug-reports" class="anchor"></a>Bug reports</h2>
<p>Please report any errors or requests regarding <code>CRBHits</code> to Kristian Ullrich (<a href="mailto:ullrich@evolbio.mpg.de" class="email">ullrich@evolbio.mpg.de</a>)</p>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Report a bug at <br><a href="https://gitlab.gwdg.de/mpievolbio-it/crbhits/issues">https://​gitlab.gwdg.de/​mpievolbio-it/​crbhits/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>
<a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a>
</li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Kristian K Ullrich <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/https://orcid.org/0000-0003-4308-9626" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Kristian K Ullrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
