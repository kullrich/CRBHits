<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>KaKs Vignette • CRBHits</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="KaKs Vignette">
<meta property="og:description" content="CRBHits">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">CRBHits</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/V01CRBHitsBasicVignette.html">CRBHits Basic Vignette</a>
    </li>
    <li>
      <a href="../articles/V02KaKsVignette.html">KaKs Vignette</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://gitlab.gwdg.de/mpievolbio-it/crbhits">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="V02KaKsVignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>KaKs Vignette</h1>
                        <h4 class="author">Kristian K Ullrich</h4>
            
            <h4 class="date">2021-01-27</h4>
      
      <small class="dont-index">Source: <a href="https://gitlab.gwdg.de/mpievolbio-it/crbhits/blob/mastervignettes/V02KaKsVignette.Rmd"><code>vignettes/V02KaKsVignette.Rmd</code></a></small>
      <div class="hidden name"><code>V02KaKsVignette.Rmd</code></div>

    </div>

    
    
<div id="kaks-vignette" class="section level1">
<h1 class="hasAnchor">
<a href="#kaks-vignette" class="anchor"></a>Ka/Ks Vignette</h1>
<ul>
<li>includes <em>Arabidopsis thalina</em> and <em>Arabidopsis lyrata</em> CRBHit pair calculation</li>
<li>includes <em>Homo sapiens</em> and <em>Pan troglodytes</em> CRBHit pair calculation</li>
<li>inlcudes Longest Isoform selection</li>
<li>includes Gene/Isoform chromosomal position extraction</li>
<li>includes Tandem Duplicate Assignment</li>
<li>includes Synteny Assignment</li>
<li>includes Ka/Ks colored Dot-Plot</li>
</ul>
<div id="table-of-contents" class="section level2">
<h2 class="hasAnchor">
<a href="#table-of-contents" class="anchor"></a>Table of Contents</h2>
<ol style="list-style-type: decimal">
<li>
<a href="#crbhpairs">Conditional Reciprocal Best Hit pairs (CRBH pairs)</a>
<ol style="list-style-type: decimal">
<li><a href="#ensembl">Download Coding Sequences (CDS) from NCBI and ENSEMBL</a></li>
<li><a href="#isoform">Get Longest Isoform from NCBI or ENSEMBL Input</a></li>
<li><a href="#crbhfilter">Calculate/Filter CRBHit pairs</a></li>
<li>
<a href="#extractposition">Extract Gene/Isoform chromosomal position</a>
<ol style="list-style-type: decimal">
<li><a href="#ncbi2genepos">Get gene position from NCBI or ENSEMBL Input</a></li>
<li><a href="#gff2genepos">Use GTF/GFF3 file to obtain gene position</a></li>
</ol>
</li>
<li><a href="#tandemduplicates">Assign Tandem Duplicates</a></li>
<li><a href="#synteny">Synteny with DAGchainer</a></li>
</ol>
</li>
<li><a href="#KaKs">Ka/Ks Calculation</a></li>
<li><a href="#KaKsFiltering">Ka/Ks Filtering and Visualisation</a></li>
<li><a href="#homosapiens"><em>Homo sapiens</em> vs. <em>Pan troglodytes</em> example</a></li>
<li><a href="#references">References</a></li>
</ol>
<p>This vignette is supposed to explain in more detail Ka/Ks calculation and it’s downstream filtering and visualization. The Ka/Ks ratio was originally developed for the analysis of genetic sequences from divergent species (<a href="https://www.nature.com/articles/267275a0">Kimura (1977)</a>, <a href="(https://doi.org/10.1093/oxfordjournals.molbev.a026236)">Yang and Nielson (2000)</a>). In short, the Ka/Ks ratio quantifies the mode and strength of selection by comparing synonymous substitution rates (Ks) (assumed to be evolutionary neutral) with nonsynonymous rates (Ka), which are exposed to selection as they change the amino acid composition of a protein (<a href="https://academic.oup.com/mbe/article/31/1/212/1049986">Mugal et al (2014)</a>).</p>
<p><a href="https://gitlab.gwdg.de/mpievolbio-it/crbhits">CRBHits</a> is a reimplementation of the Conditional Reciprocal Best Hit (CRBH) algorithm <a href="https://github.com/cboursnell/crb-blast">crb-blast</a> in R. The CRBHit pairs can be directly used to calculate Ka/Ks ratios and to filter for tandem duplicates or syntenic groups.</p>
<p>See the R package page for a detailed description of the install process and its dependencies <a href="https://mpievolbio-it.pages.gwdg.de/crbhits/">https://mpievolbio-it.pages.gwdg.de/crbhits/</a> or have a look at the <a href="https://mpievolbio-it.pages.gwdg.de/crbhits/articles/V01CRBHitsBasicVignette.html">CRBHits Basic Vignette</a>.</p>
<p><strong>Note:</strong></p>
<p>In this Vignette the <code>lastpath</code> is defined as <code>vignette.paths[1]</code>, the <code>kakscalcpath</code> as <code>vignette.paths[2]</code> and the <code>dagchainerpath</code> as <code>vignette.paths[3]</code> to be able to build the Vignette.</p>
<p>However, once you have compiled last-1177, KaKs_Calculator2.0 and DAGchainer with the functions <code><a href="../reference/make_last.html">make_last()</a></code>, <code><a href="../reference/make_KaKs_Calculator2.html">make_KaKs_Calculator2()</a></code> and <code><a href="../reference/make_dagchainer.html">make_dagchainer()</a></code> you won’t need to specify the paths anymore. Please remove them if you would like to repeat the examples.</p>
<pre><code><a href="https://gitlab.gwdg.de/mpievolbio-it/crbhits">## load vignette specific libraries
library(CRBHits)
suppressPackageStartupMessages(library(Biostrings))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(gridExtra))
suppressPackageStartupMessages(library(curl))
## compile LAST, KaKs_Calculator2.0 and DAGchainer for the vignette
vignette.paths &lt;- make_vignette()</a></code></pre>
</div>
<div id="conditional-reciprocal-best-hit-pairs" class="section level2">
<h2 class="hasAnchor">
<a href="#conditional-reciprocal-best-hit-pairs" class="anchor"></a>1. <span id="crbhpairs">Conditional reciprocal best hit pairs</span>
</h2>
<p>The CRBH algorithm builds upon the classical reciprocal best hit (RBH) approach to find orthologous sequences between two sets of sequences by defining an expect-value cutoff per alignment length. Further, this cutoff is used to retain secondary hits as additional <em>bona-fide</em> homologues.</p>
<p>See the R package page and the <a href="https://mpievolbio-it.pages.gwdg.de/crbhits/articles/V01CRBHitsBasicVignette.html">CRBHits Basic Vignette</a> for a more detailed description of the CRBH algorithm.</p>
<div id="download-coding-sequences-cds-from-ncbi-and-ensembl" class="section level3">
<h3 class="hasAnchor">
<a href="#download-coding-sequences-cds-from-ncbi-and-ensembl" class="anchor"></a>1.1. <span id="ensembl">Download Coding sequences (CDS) from NCBI and ENSEMBL</span>
</h3>
<p>To calculate CRBHit pairs between two species, one can directly use an URL to access the coding sequences and calculate the CRBH pairs matrix.</p>
<p>Two examples are given in this vignette.</p>
<p>The first example compares the coding sequences from <em>Arabidopsis thaliana</em> and <em>Arabidopsis lyrata</em>. The input sequences are from the FTP server from <a href="ftp://ftp.ncbi.nlm.nih.gov/genomes/all/">NCBI Genomes</a>.</p>
<p>The second example compares the CDS from <em>Homo sapiens</em> and <em>Pan troglodytes</em> (see <a href="#homosapiens"><em>Homo sapiens</em> vs. <em>Pan troglodytes</em> example</a>).</p>
<p>As an alternative the <a href="ftp://ftp.ensemblgenomes.org/pub/plants/release-48/fasta/">EnsemblPlants release-48</a> can used.</p>
<pre><code>## set URLs for Arabidopis thaliana and Arabidopsis lyrata from NCBI Genomes

## set NCBI URL
NCBI &lt;- "https://ftp.ncbi.nlm.nih.gov/genomes/all/"
## set Arabidopsis thaliana CDS URL
ARATHA.cds.url &lt;- paste0(NCBI, "GCF/000/001/735/GCF_000001735.4_TAIR10.1/",
                      "GCF_000001735.4_TAIR10.1_cds_from_genomic.fna.gz")

## set Arabidopsis lyrata CDS URL
ARALYR.cds.url &lt;- paste0(NCBI, "GCF/000/004/255/GCF_000004255.2_v.1.0/",
                      "GCF_000004255.2_v.1.0_cds_from_genomic.fna.gz")
## get Arabidopsis thaliana CDS
ARATHA.cds &lt;- Biostrings::readDNAStringSet(ARATHA.cds.url)
## get Arabidopsis lyrata CDS
ARALYR.cds &lt;- Biostrings::readDNAStringSet(ARALYR.cds.url)</code></pre>
</div>
<div id="get-longest-isoform-from-ncbi-or-ensembl-input" class="section level3">
<h3 class="hasAnchor">
<a href="#get-longest-isoform-from-ncbi-or-ensembl-input" class="anchor"></a>1.2. <span id="isoform">Get Longest Isoform from NCBI or ENSEMBL Input</span>
</h3>
<p>Prior CRBHit pairs calculation, the longest isoforms can be selected, if the data was downloaded from NCBI or Ensembl.</p>
<p><strong>Note:</strong> This is an important step. If e.g. isoforms are used, the Ka/Ks calculations might show biased values inspecting mean or median Ka/Ks values grouped per query sequence.</p>
<pre><code>## get longest isoforms

## get longest isoform
ARATHA.cds.longest &lt;- isoform2longest(ARATHA.cds, "NCBI")
ARALYR.cds.longest &lt;- isoform2longest(ARALYR.cds, "NCBI")

## get help
#?cds2longest</code></pre>
</div>
<div id="calculatefilter-crbhit-pairs" class="section level3">
<h3 class="hasAnchor">
<a href="#calculatefilter-crbhit-pairs" class="anchor"></a>1.3. <span id="crbhfilter">Calculate/Filter CRBHit pairs</span>
</h3>
<p>The blast-like software <a href="http://last.cbrc.jp/">LAST</a> is used to compare the translated CDS against each other and output a blast-like output table including the query and target length.</p>
<p>The hit pairs are filtered prior fitting for a query coverage of 50% and the <strong>twilight zone of protein sequence alignments</strong> (<a href="https://academic.oup.com/peds/article/12/2/85/1550637">Rost B. (1999)</a>).</p>
<p>The CRBhit pairs can be calculated directly from the URLs with the function <code><a href="../reference/cdsfile2rbh.html">cdsfile2rbh()</a></code> using multiple threads including longest isoform selection.</p>
<p>For a detailed description of the <code><a href="../reference/cdsfile2rbh.html">cdsfile2rbh()</a></code> function and the <code><a href="../reference/cds2rbh.html">cds2rbh()</a></code> function with its individual filtering steps prior CRBH algorithm fitting see the <a href="https://mpievolbio-it.pages.gwdg.de/crbhits/articles/V01CRBHitsBasicVignette.html">CRBHits Basic Vignette</a>.</p>
<pre><code>## calculate CRBHit pairs for A. thaliana and A. lyrata using 2 threads

## input from CDS obtained from NCBI
## longest isoform selection
## query coverage &gt;= 50%
## rost199 filter
ARATHA_ARALYR_crbh &lt;- cds2rbh(ARATHA.cds,
                              ARALYR.cds,
                              qcov = 0.5, rost1999 = TRUE,
                              longest.isoform = TRUE,
                              isoform.source = "NCBI",
                              threads = 2, plotCurve = TRUE,
                              lastpath = vignette.paths[1])

## get help
#?cds2rbh</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-4-1.png" alt=""><p class="caption">Figure: CRBHit pairs between A. thaliana and A. lyrata</p>
</div>
</div>
<div id="extract-geneisoform-chromosomal-position" class="section level3">
<h3 class="hasAnchor">
<a href="#extract-geneisoform-chromosomal-position" class="anchor"></a>1.4. <span id="extractposition">Extract Gene/Isoform chromosomal position</span>
</h3>
<p>To be able to filter for <em>Tandem Duplicates</em> and to plot a dotplot, one needs to have annotated gene positions per chromosome/contig. With the <code><a href="../reference/cds2genepos.html">cds2genepos()</a></code> function it is possible to directly access this information if the data was obtained from NCBI or Ensembl.</p>
<p>Chromosomal gene positions might overlap and if one has not filtered to use the longest or primary isoform there will be positions overlap for CDS. To overcome this issue it is recommended to first reduce the CDS Input to the longest isoform (see <a href="#isoform">Get Longest Isoform from NCBI or ENSEMBL Input</a>).</p>
<p><strong>Note:</strong> It is also possible to obtain and define chromosomal gene positions from other sources, like parsing a GTF/GFF file and supply a manual curated genepos matrix. In the same way this process might be used to select the longest/primary isoform from CDS Input sources other than NCBI or Ensembl. This special case is handled here:</p>
<div id="get-gene-position-from-ncbi-or-ensembl-input" class="section level4">
<h4 class="hasAnchor">
<a href="#get-gene-position-from-ncbi-or-ensembl-input" class="anchor"></a>1.4.1. <span id="ncbi2genepos">Get gene position from NCBI or ENSEMBL Input</span>
</h4>
<p>If the CDS Input was obtained from NCBI or ENSEMBL, the gene position can be directly extracted from the <code>DNAStringSet</code> as follows.</p>
<pre><code>## get gene position idx from NCBI CDS

## extract gene position from CDS
ARATHA.cds.genepos &lt;- cds2genepos(ARATHA.cds, source = "NCBI")
## extract gene position from longest isoform CDS
ARATHA.cds.longest.genepos &lt;- cds2genepos(ARATHA.cds.longest, source = "NCBI")
## show first entries
head(ARATHA.cds.genepos)
head(ARATHA.cds.longest.genepos)
## get number of gene isoforms with same index
table(table(ARATHA.cds.genepos$gene.idx))
table(table(ARATHA.cds.longest.genepos$gene.idx))

##get help
#?cds2genepos</code></pre>
</div>
<div id="use-gtfgff3-file-to-obtain-gene-position" class="section level4">
<h4 class="hasAnchor">
<a href="#use-gtfgff3-file-to-obtain-gene-position" class="anchor"></a>1.4.2. <span id="gff2genepos">Use GTF/GFF3 file to obtain gene position</span>
</h4>
<p>As noted above, it is also possible to obtain gene position and corresponding the longest isoforms per gene annotated in a GTF/GFF3 file.</p>
<p>see <a href="http://www.ensembl.org/info/website/upload/gff3.html">GTF/GFF3 format</a></p>
<p><strong>Note:</strong> In some cases the IDs provided in the CDS and the GTF/GFF3 file differ, which make it more complicated to directly link gene position and CDS.</p>
<p>Here, as an example, the GFF3 file for the species <em>Arabidopsis thaliana</em> is obtained from the FTP server from <a href="https://plants.ensembl.org/index.html">Ensembl Plants</a>.</p>
<p><strong>Note:</strong> The GFF3 and GTF files can be very large and it might take some time until this data is loaded into memory.</p>
<pre><code>## get gene position idx from GTF/GFF3

## set NCBI URL
ensemblPlants &lt;- "ftp://ftp.ensemblgenomes.org/pub/plants/release-48/"
## set Arabidopsis thaliana GFF3 URL
ARATHA.GFF.url &lt;- paste0(ensemblPlants, "gff3/arabidopsis_thaliana/",
                      "Arabidopsis_thaliana.TAIR10.48.gff3.gz")
## downlaod and gunzip file
ARATHA.GFF.file &lt;- tempfile()
ARATHA.GFF.file.gz &lt;- paste0(ARATHA.GFF.file, ".gz")
download.file(ARATHA.GFF.url, ARATHA.GFF.file.gz, quiet = FALSE)
system(paste0("gunzip -f ", ARATHA.GFF.file.gz))
## read ARATHA.GFF.file
ARATHA.gff &lt;- read.table(ARATHA.GFF.file, sep = "\t", 
                         quote = "", header = FALSE)
colnames(ARATHA.gff) &lt;- c("seqname", "source", "feature", "start", "end", "score", "strand", "frame", "attribute")

## extract gene
ARATHA.gff.gene &lt;- ARATHA.gff %&gt;% dplyr::filter(feature == "gene")
## get gene ID
ARATHA.gff.gene.id &lt;- gsub("ID\\=", "", 
                           stringr::word(ARATHA.gff.gene$attribute,
                           1, sep=";"))
## extract mRNA
ARATHA.gff.mRNA &lt;- ARATHA.gff %&gt;% dplyr::filter(feature == "mRNA")
## get mRNA ID
ARATHA.gff.mRNA.id &lt;- gsub("ID\\=", "", 
                           stringr::word(ARATHA.gff.mRNA$attribute,
                           1, sep=";"))
## get mRNA based gene ID
ARATHA.gff.mRNA.parent.id &lt;- gsub("Parent\\=", "", 
                                  stringr::word(ARATHA.gff.mRNA$attribute,
                                  2, sep=";"))
## add mRNA ID and mRNA based gene ID
ARATHA.gff.mRNA &lt;- ARATHA.gff.mRNA %&gt;% 
                     dplyr::mutate(gene.id = ARATHA.gff.mRNA.parent.id,
                                   mRNA.id = ARATHA.gff.mRNA.id)
## extract CDS
ARATHA.gff.CDS &lt;- ARATHA.gff %&gt;% dplyr::filter(feature == "CDS")
## get CDS based mRNA ID
ARATHA.gff.CDS.parent.id &lt;- gsub("Parent\\=", "", 
                                 stringr::word(ARATHA.gff.CDS$attribute,
                                 2, sep=";"))
## add CDS based mRNA ID
ARATHA.gff.CDS &lt;- ARATHA.gff.CDS %&gt;%
                    dplyr::mutate(mRNA.id = ARATHA.gff.CDS.parent.id)
## get width per mRNA isoform
ARATHA.gff.mRNA.len &lt;- ARATHA.gff.CDS %&gt;% dplyr::group_by(mRNA.id) %&gt;%
                         dplyr::summarise(mRNA.id = unique(mRNA.id),
                                          len = sum(end-start))
## add mRNA isoform width
ARATHA.gff.mRNA &lt;- ARATHA.gff.mRNA %&gt;% 
                    dplyr::mutate(mRNA.len = 
                    ARATHA.gff.mRNA.len$len[
                        match(ARATHA.gff.mRNA$mRNA.id, 
                              ARATHA.gff.mRNA.len$mRNA.id)])
## retain only longest mRNA isoform
ARATHA.gff.mRNA.longest &lt;- ARATHA.gff.mRNA %&gt;% dplyr::arrange(seqname, start,
  gene.id, desc(mRNA.len)) %&gt;% dplyr::distinct(gene.id, .keep_all = TRUE) %&gt;% 
  dplyr::mutate(gene.mid = (start+end)/2)
## add gene idx
ARATHA.gff.mRNA.longest &lt;- ARATHA.gff.mRNA.longest %&gt;% 
  dplyr::mutate(gene.idx = seq(from = 1, to = dim(ARATHA.gff.mRNA.longest)[1]))
## create gene position matrix to be used for downstream analysis
ARATHA.gff.genepos &lt;- ARATHA.gff.mRNA.longest %&gt;% dplyr::select(
  gene.seq.id = mRNA.id,
  gene.chr = seqname,
  gene.start = start,
  gene.end = end,
  gene.mid = gene.mid,
  gene.strand = strand,
  gene.idx = gene.idx)
## set attribute
attr(ARATHA.gff.genepos, "CRBHits.class") &lt;- "genepos"
## show first entries of generated gene position
head(ARATHA.gff.genepos)</code></pre>
</div>
</div>
<div id="assign-tandem-duplicates" class="section level3">
<h3 class="hasAnchor">
<a href="#assign-tandem-duplicates" class="anchor"></a>1.5 <span id="tandemduplicates">Assign Tandem Duplicates</span>
</h3>
<p>Tandem duplicated genes (gene family members that are tightly clustered on a chromosome) are common in plant genomes and can show different Ka/Ks distribution than non tandem duplicates or other segmental duplicated genes (<a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.0020115">Rizzon et al., 2006</a>).</p>
<p>In order to account for this, it is possible to classify these tandem duplicates with the <code><a href="../reference/tandemdups.html">tandemdups()</a></code> function.</p>
<p><strong>Note:</strong> To be able to classify tandem duplicated genes within one genome, one needs to calculate selfblast based CRBHit pairs and provide gene position information for the same input data.</p>
<p>The following example shows how one can:</p>
<ol style="list-style-type: decimal">
<li>get selfblast CRBHit pairs</li>
<li>get gene positions</li>
<li>assign tandem duplicates</li>
</ol>
<pre><code>## example to assign tandem duplicates given selfblast CRBHit pairs and gene position

## get selfblast CRBHit pairs for A. thaliana
ARATHA_selfblast_crbh &lt;- cds2rbh(ARATHA.cds,
                                 ARATHA.cds,
                                 qcov = 0.5, rost1999 = TRUE,
                                 longest.isoform = TRUE,
                                 isoform.source = "NCBI",
                                 threads = 2, plotCurve = TRUE,
                                 lastpath = vignette.paths[1])</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-7-1.png" alt=""><p class="caption">Figure: selfblast CRBHit pairs between of A. thaliana</p>
</div>
<pre><code>## get selfblast CRBHit pairs for A. lyrata
ARALYR_selfblast_crbh &lt;- cds2rbh(ARALYR.cds,
                                 ARALYR.cds,
                                 qcov = 0.5, rost1999 = TRUE,
                                 longest.isoform = TRUE,
                                 isoform.source = "NCBI",
                                 threads = 2, plotCurve = TRUE,
                                 lastpath = vignette.paths[1])</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-7-2.png" alt=""><p class="caption">Figure: selfblast CRBHit pairs between of A. lyrata</p>
</div>
<pre><code>## get gene position for A. thaliana longest isoforms
ARATHA.cds.longest.genepos &lt;- cds2genepos(ARATHA.cds.longest, source = "NCBI")
## get gene position for A. lyrata longest isoforms
ARALYR.cds.longest.genepos &lt;- cds2genepos(ARALYR.cds.longest, source = "NCBI")

## assign tandem duplicates for A. thaliana
ARATHA.cds.longest.tandemdups &lt;- tandemdups(rbhpairs = ARATHA_selfblast_crbh,
                                            genepos = ARATHA.cds.longest.genepos,
                                            dupdist = 5)

## assign tandem duplicates for A. lyrata
ARALYR.cds.longest.tandemdups &lt;- tandemdups(rbhpairs = ARALYR_selfblast_crbh,
                                            genepos = ARALYR.cds.longest.genepos,
                                            dupdist = 5)
## get help
#?tandemdups</code></pre>
<p>The resulting tandem duplicated genes detected can be plotted given their chromosomal gene position as follows:</p>
<pre><code>## example how to plot tandem duplicated gene groups

## get tandem group size
tandem_group_size &lt;- ARATHA.cds.longest.tandemdups %&gt;%
  dplyr::group_by(tandem_group) %&gt;% dplyr::group_size()
table(tandem_group_size)

## use dplyr::mutate to assign group size
ARATHA.cds.longest.tandemdups &lt;- ARATHA.cds.longest.tandemdups %&gt;%
  dplyr::mutate(tandem_group_size = unlist(apply(cbind(tandem_group_size,
  tandem_group_size), 1, function(x) rep(x[1], x[2]))))

## use dplyr::group_by to plot group by chromosome and colored by group size
ARATHA.cds.longest.tandemdups %&gt;% dplyr::group_by(gene.chr) %&gt;%
  ggplot2::ggplot(aes(x = gene.mid, y = gene.mid)) +
  ggplot2::geom_point(shape = 20, aes(col = as.factor(tandem_group_size))) +
  ggplot2::facet_wrap(~ gene.chr) +
  ggplot2::scale_colour_manual(values = CRBHitsColors(length(table(tandem_group_size))))</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-8-1.png" alt=""><p class="caption">Figure: Tandem duplicates between A. thaliana and A. lyrata</p>
</div>
</div>
<div id="synteny-with-dagchainer" class="section level3">
<h3 class="hasAnchor">
<a href="#synteny-with-dagchainer" class="anchor"></a>1.6 <span id="synteny">Synteny with DAGchainer</span>
</h3>
<p>Chains of collinear gene pairs can represent segmentally duplicated regions and genes within a single genome or syntenic regions between related genomes (<a href="https://doi.org/10.1093/bioinformatics/bth397">Haas et al., 2004</a>).</p>
<p>There exists external tools which can be used to infer syntenic regions, like e.g. <a href="https://genomevolution.org/CoGe/SynMap.pl">SynMap</a> as published by <a href="https://academic.oup.com/bioinformatics/article/33/14/2197/3072872">Haug-Baltzell A. et al., 2017</a>.</p>
<p>Within CRBHits the tool <a href="http://dagchainer.sourceforge.net/">DAGchainer</a> published by <a href="https://doi.org/10.1093/bioinformatics/bth397">Haas et al., 2004</a> can be directly applied on the CRBHit pairs.</p>
<p>The following example shows how one can run <a href="http://dagchainer.sourceforge.net/">DAGchainer</a> on CRBHit pairs and gene positions to get syntenic information about the CRBHit pairs.</p>
<pre><code>## example how to run DAGchainer on CRBHit pairs and gene positions

## DAGchainer using gene base pair (gene bp start end)
## Note: change parameter to fit bp option
ARATHA_ARALYR_crbh.dagchainer.bp &lt;- rbh2dagchainer(rbhpairs = ARATHA_ARALYR_crbh, 
                                      gene.position.cds1 = ARATHA.cds.longest.genepos,
                                      gene.position.cds2 = ARALYR.cds.longest.genepos,
                                      type = "bp",
                                      gap_length = 10000,
                                      max_dist_allowed = 200000,
                                      dagchainerpath = vignette.paths[3])

## DAGchainer using gene index (gene order)
ARATHA_ARALYR_crbh.dagchainer.idx &lt;- rbh2dagchainer(rbhpairs = ARATHA_ARALYR_crbh, 
                                       gene.position.cds1 = ARATHA.cds.longest.genepos,
                                       gene.position.cds2 = ARALYR.cds.longest.genepos,
                                       type = "idx",
                                       gap_length = 1,
                                       max_dist_allowed = 20,
                                       dagchainerpath = vignette.paths[3])

## get help
#?rbh2dagchainer</code></pre>
<p>A plotting function <code><a href="../reference/plot_dagchainer.html">plot_dagchainer()</a></code> is integrated and can be directly applied on the DAGchainer results.</p>
<pre><code><a href="../reference/plot_dagchainer.html">## example how to plot pairwise chromosomal syntenic groups (DAGchainer results)

## plot DAGchainer results for each chromosome combination
plot_dagchainer(ARATHA_ARALYR_crbh.dagchainer.bp)</a></code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-10-1.png" alt=""><p class="caption">Figure: Dagchainer results of A. thaliana and A. lyrata</p>
</div>
<pre><code>## plot DAGchainer results selected chromosomes
g &lt;- plot_dagchainer(ARATHA_ARALYR_crbh.dagchainer.bp,
                     select.chr = c("NC_003070.9", "NC_003071.7", "NC_003074.8",
                                    "NC_003075.7", "NC_003076.8",
                                    "NW_003302551.1", "NW_003302554.1",
                                    "NW_003302553.1", "NW_003302552.1",
                                    "NW_003302551.1", "NW_003302550.1",
                                    "NW_003302549.1", "NW_003302548.1"))
g</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-10-2.png" alt=""><p class="caption">Figure: Dagchainer results selected chromosomes</p>
</div>
<pre><code>## change title size
g + ggplot2::theme(title = element_text(size = 16))</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-10-3.png" alt=""><p class="caption">Figure: Dagchainer results altered title size</p>
</div>
<pre><code>## change axis title size (gene1.mid; gene2.mid)
g + ggplot2::theme(axis.title.x = element_text(size = 16),
                   axis.title.y = element_text(size = 16))</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-10-4.png" alt=""><p class="caption">Figure: Dagchainer results altered axis title size</p>
</div>
<pre><code>## change grid title size
g + theme(strip.text.x = element_text(size = 16), strip.text.y = element_text(size = 16))</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-10-5.png" alt=""><p class="caption">Figure: Dagchainer results altered grid title size</p>
</div>
<pre><code>## change grid axis size and angle
g + theme(axis.text.x = element_text(size = 12, angle = 90))</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-10-6.png" alt=""><p class="caption">Figure: Dagchainer results altered grid angle</p>
</div>
<pre><code>## get help
#?plot_dagchainer</code></pre>
</div>
</div>
<div id="kaks-calculation" class="section level2">
<h2 class="hasAnchor">
<a href="#kaks-calculation" class="anchor"></a>2. <span id="KaKs">Ka/Ks Calculation</span>
</h2>
<p>The second part of this vignette describes how to calculate synonymous (Ks) and nonsynonymous substitution rates (Ka) given a set of CRBHit pairs (see <a href="#crbhfilter">Calculate/Filter CRBHit pairs</a> section how to obtain CRBHit pairs).</p>
<p>The <code><a href="../reference/rbh2kaks.html">rbh2kaks()</a></code> function is used to obtain pairwise codon alignments and directly calculate synonymous (Ks) and nonsynonymous (Ka) substitutions in a parallel fashion. One can choose either to use the model by <a href="https://doi.org/10.1007/bf02407308">Li (1993)</a> or the model by <a href="https://doi.org/10.1093/oxfordjournals.molbev.a026236">Yang and Nielson (2000)</a>.</p>
<p><strong>Note:</strong></p>
<p>It is important, that the names of the <code>rbh</code> columns must match the names of the corresponding <code>cds1</code> and <code>cds2</code> <code>DNAStringSet</code> vectors.</p>
<p>However, since one should directly use the same input <code>DNAStringSet</code> vector or input <code>url</code> to calculate the CRBHit pairs with the <code><a href="../reference/cds2rbh.html">cds2rbh()</a></code> or the <code><a href="../reference/cdsfile2rbh.html">cdsfile2rbh()</a></code> function, this should not be a problem (see the <a href="#isoform">Get Longest Isoform from NCBI or ENSEMBL Input</a> section how to obtain the CDS for the next example).</p>
<p>To calculate Ka/Ks values based on the model by <a href="https://doi.org/10.1007/bf02407308">Li (1993)</a>, do the following:</p>
<p><strong>Note:</strong> The following example can take some time and is not calculated by the vignette building process.</p>
<pre><code>## example how to calculate Ka/Ks values with model "Li"

## calculate Ka/Ks using the CRBHit pairs and multiple threads
ARATHA_ARALYR_crbh.kaks.Li &lt;- rbh2kaks(rbhpairs = ARATHA_ARALYR_crbh,
                                       cds1 = ARATHA.cds.longest,
                                       cds2 = ARALYR.cds.longest,
                                       model = "Li",
                                       threads = 4)</code></pre>
<p>To calculate Ka/Ks values based on the model by <a href="https://doi.org/10.1093/oxfordjournals.molbev.a026236">Yang and Nielson (2000)</a>, do the following:</p>
<p><strong>Note:</strong> The following example can take some time and is not calculated by the vignette building process.</p>
<pre><code>## example how to calculate Ka/Ks values with model "YN"

## calculate Ka/Ks using the CRBHit pairs and multiple threads
ARATHA_ARALYR_crbh.kaks.Li &lt;- rbh2kaks(rbhpairs = ARATHA_ARALYR_crbh,
                                       cds1 = ARATHA.cds.longest,
                                       cds2 = ARALYR.cds.longest,
                                       model = "YN",
                                       threads = 4)</code></pre>
</div>
<div id="kaks-filtering-and-visualisation" class="section level2">
<h2 class="hasAnchor">
<a href="#kaks-filtering-and-visualisation" class="anchor"></a>3. <span id="KaKsFiltering">Ka/Ks Filtering and Visualisation</span>
</h2>
<p>In some cases the Ka/Ks calculation fails, since e.g. there are no synonymous (Ks) or nonsynonymous substitutions (Ka) between cds1 and cds2 or one wants to get rid of high Ks values due to substitution saturation. One can easily remove these cases before doing further analysis.</p>
<p>A plotting function <code><a href="../reference/plot_kaks.html">plot_kaks()</a></code> is integrated and can be applied on the Ka/Ks results.</p>
<pre><code><a href="https://rdrr.io/r/utils/data.html">## load example Ka/Ks values (see above commands above how to obtain them)
data("ath_aly_ncbi_kaks", package="CRBHits")

## plot Ka/Ks results as histogram colored by Ka/Ks values
g &lt;- plot_kaks(ath_aly_ncbi_kaks)</a></code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-11-1.png" alt=""><p class="caption">Figure: Ka/Ks results as histogram colored by Ka/ks</p>
</div>
<pre><code>## plot Ka/Ks results as histogram filter for ka.min, ka.max, ks.min, ks.max
g.min_max &lt;- plot_kaks(ath_aly_ncbi_kaks, ka.min = 0, ka.max = 1, ks.min = 0, ks.max = 1)</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-11-2.png" alt=""><p class="caption">Figure: Ka/Ks results filtered for ka.min, ka.max, ks.max</p>
</div>
<pre><code><a href="https://rdrr.io/r/utils/head.html">## select subset of chromosomes - needs gene position information
head(ARATHA.cds.longest.genepos)
head(ARALYR.cds.longest.genepos)
g.subset &lt;- plot_kaks(ath_aly_ncbi_kaks,
                      gene.position.cds1 = ARATHA.cds.longest.genepos,
                      gene.position.cds2 = ARALYR.cds.longest.genepos,
                      select.chr = c("NC_003070.9", "NC_003071.7",
                        "NW_003302551.1", "NW_003302554.1"))</a></code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-11-3.png" alt=""><p class="caption">Figure: Ka/Ks results filtered for chromosomes</p>
</div>
<pre><code>## plot Ka/Ks results and split by chromosome - needs gene position information

g.split &lt;- plot_kaks(ath_aly_ncbi_kaks,
                     gene.position.cds1 = ARATHA.cds.longest.genepos,
                     gene.position.cds2 = ARALYR.cds.longest.genepos,
                     select.chr = c("NC_003070.9", "NC_003071.7",
                        "NW_003302551.1", "NW_003302554.1"),
                     splitByChr = TRUE)</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-11-4.png" alt=""><p class="caption">Figure: Ka/Ks results split by chromosomes</p>
</div>
<p><strong>Note:</strong> Default <strong>data.frame</strong> handling with the <strong>dplyr</strong> package is possible on the original Ka/Ks results as well as on the resulting plot objects.</p>
<p>Apply <code><a href="https://dplyr.tidyverse.org/reference/filter.html">dplyr::filter()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/mutate.html">dplyr::mutate()</a></code> function:</p>
<pre><code><a href="https://rdrr.io/r/utils/head.html">## examples how to filter and mutate Ka/Ks results

## filter for Ks values &lt; 2 on original Ka/Ks results
head(ath_aly_ncbi_kaks)
dim(ath_aly_ncbi_kaks)
dim(ath_aly_ncbi_kaks %&gt;% dplyr::filter(ks &lt; 2))

## filter for Ks values &lt; 2 on plot object
head(g.split$g.kaks$data)
dim(g.split$g.kaks$data)
dim(g.split$g.kaks$data %&gt;% dplyr::filter(ks &lt; 2))

## filter for Ks values &lt; 1 on plot object and plot
g.split$g.kaks$data %&gt;% dplyr::filter(ks &lt; 1) %&gt;%
  ggplot2::ggplot() + ggplot2::geom_histogram(binwidth = 0.1, aes(x = ks))</a></code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-12-1.png" alt=""><p class="caption">Figure: Ks results as histogram</p>
</div>
</div>
<div id="homo-sapiens-vs--pan-troglodytes-example" class="section level2">
<h2 class="hasAnchor">
<a href="#homo-sapiens-vs--pan-troglodytes-example" class="anchor"></a>4. <span id="homosapiens"><em>Homo sapiens</em> vs. <em>Pan troglodytes</em> example</span>
</h2>
<p>The second example compares the CDS from <em>Homo sapiens</em> and <em>Pan troglodytes</em>. The input sequences are from the FTP server from <a href="https://ensembl.org/index.html">Ensembl</a>.</p>
<p>The <a href="ftp://ftp.ensembl.org/pub/release-101/fasta/">Ensembl release-101</a> is used.</p>
<pre><code>## example comparing Homo sapiens and Pan troglodytes

## set URLs for Homo sapiens and Pan troglodytes from Ensembl

## set Ensembl URL
ensembl &lt;- "ftp://ftp.ensembl.org/pub/release-101/fasta/"
## set Homo sapiens CDS URL
HOMSAP.cds.url &lt;- paste0(ensembl, "homo_sapiens/cds/Homo_sapiens.GRCh38.cds.all.fa.gz")
## set Pan troglodytes CDS URL
PANTRO.cds.url &lt;- paste0(ensembl, "pan_troglodytes/cds/Pan_troglodytes.Pan_tro_3.0.cds.all.fa.gz")

## get Homo sapiens CDS
HOMSAP.cds.file &lt;- tempfile()
download.file(HOMSAP.cds.url, HOMSAP.cds.file, quiet = FALSE)
HOMSAP.cds &lt;- Biostrings::readDNAStringSet(HOMSAP.cds.file)

## get Pan troglodytes CDS
PANTRO.cds.file &lt;- tempfile()
download.file(PANTRO.cds.url, PANTRO.cds.file, quiet = FALSE)
PANTRO.cds &lt;- Biostrings::readDNAStringSet(PANTRO.cds.file)

## get longest isoform
HOMSAP.cds.longest &lt;- isoform2longest(HOMSAP.cds, "ENSEMBL")
PANTRO.cds.longest &lt;- isoform2longest(PANTRO.cds, "ENSEMBL")

## calculate CRBHit pairs for H. sapiens and P. troglodytes using 2 threads

## input from CDS obtained from Ensembl
## longest isoform selection
## query coverage &gt;= 50%
## rost199 filter
HOMSAP_PANTRO_crbh &lt;- cds2rbh(HOMSAP.cds,
                              PANTRO.cds,
                              qcov = 0.5, rost1999 = TRUE,
                              longest.isoform = TRUE,
                              isoform.source = "ENSEMBL",
                              threads = 2, plotCurve = TRUE,
                              lastpath = vignette.paths[1])</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-13-1.png" alt=""><p class="caption">Figure: CRBHit pairs of H. sapiens and P. troglodytes</p>
</div>
<pre><code>## get gene position for H. sapiens longest isoforms
HOMSAP.cds.longest.genepos &lt;- cds2genepos(HOMSAP.cds.longest, source = "ENSEMBL")
## get gene position for P. troglodytes longest isoforms
PANTRO.cds.longest.genepos &lt;- cds2genepos(PANTRO.cds.longest, source = "ENSEMBL")

## DAGchainer using gene base pair (gene bp start end)
## Note: change parameter to fit bp option
HOMSAP_PANTRO_crbh.dagchainer.bp &lt;- rbh2dagchainer(rbhpairs = HOMSAP_PANTRO_crbh, 
                                      gene.position.cds1 = HOMSAP.cds.longest.genepos,
                                      gene.position.cds2 = PANTRO.cds.longest.genepos,
                                      type = "bp",
                                      gap_length = 10000,
                                      max_dist_allowed = 200000,
                                      dagchainerpath = vignette.paths[3])

## plot DAGchainer results for selected chromosome combinations
plot_dagchainer(HOMSAP_PANTRO_crbh.dagchainer.bp, select.chr = c("1","2","3","4","5","14"))</code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-13-2.png" alt=""><p class="caption">Figure: Dagchainer results of H. sapiens and P. troglodytes</p>
</div>
<p><strong>Note:</strong> The following example can take some time and is not calculated by the vignette building process.</p>
<pre><code>## example how to calculate Ka/Ks values with model "Li"

## calculate Ka/Ks using the CRBHit pairs and multiple threads
HOMSAP_PANTRO_crbh.kaks.Li &lt;- rbh2kaks(HOMSAP_PANTRO_crbh,
                                       HOMSAP.cds.longest,
                                       PANTRO.cds.longest,
                                       model = "Li",
                                       threads = 4)</code></pre>
<pre><code><a href="https://rdrr.io/r/utils/data.html">## load example Ka/Ks values (see above commands above how to obtain them)
data("hom_pan_ensembl_kaks", package="CRBHits")

## plot Ka/Ks results as histogram colored by Ka/Ks values
g &lt;- plot_kaks(hom_pan_ensembl_kaks)</a></code></pre>
<div class="figure">
<img src="V02-unnamed-chunk-14-1.png" alt=""><p class="caption">Figure: Ka/Ks results of H. sapiens and P. troglodytes</p>
</div>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>5. <span id="references">References</span>
</h2>
<p>Aubry S., Kelly S., Kümpers B. M., Smith-Unna R. D., and Hibberd J. M. (2014). <strong>Deep evolutionary comparison of gene expression identifies parallel recruitment of trans-factors in two independent origins of C4 photosynthesis.</strong> <em>PLoS Genetics</em>, <strong>10(6)</strong>. <a href="https://doi.org/10.1371/journal.pgen.1004365">https://doi.org/10.1371/journal.pgen.1004365</a></p>
<p>Charif D., and Lobry J. R. (2007). <strong>SeqinR 1.0-2: a contributed package to the R project for statistical computing devoted to biological sequences retrieval and analysis.</strong> <em>In Structural approaches to sequence evolution</em> (pp. 207-232). Springer, Berlin, Heidelberg. <a href="https://link.springer.com/chapter/10.1007/978-3-540-35306-5_10">https://link.springer.com/chapter/10.1007/978-3-540-35306-5_10</a></p>
<p>Duong T., and Wand M. (2015). <strong>feature: Local Inferential Feature Significance for Multivariate Kernel Density Estimation.</strong> <em>R package version 1.2.13</em>. <a href="https://cran.r-project.org/web/packages/feature/">https://cran.r-project.org/web/packages/feature/</a></p>
<p>Haas B. J., Delcher A. L., Wortman J. R., and Salzberg S. L. (2004). <strong>DAGchainer: a tool for mining segmental genome duplications and synteny.</strong> <em>Bioinformatics</em>, <strong>20(18)</strong>, 3643-3646. <a href="https://doi.org/10.1093/bioinformatics/bth397">https://doi.org/10.1093/bioinformatics/bth397</a></p>
<p>Haug-Baltzell A., Stephens S. A., Davey S., Scheidegger C. E., Lyons E. (2017). <strong>SynMap2 and SynMap3D: web-based wholge-genome synteny browsers.</strong> <em>Bioinformatics</em>, <strong>33(14)</strong>, 2197-2198. <a href="https://academic.oup.com/bioinformatics/article/33/14/2197/3072872">https://academic.oup.com/bioinformatics/article/33/14/2197/3072872</a></p>
<p>Kiełbasa S. M., Wan R., Sato K., Horton P., and Frith M. C. (2011). <strong>Adaptive seeds tame genomic sequence comparison.</strong> <em>Genome Research</em>, <strong>21(3)</strong>, 487-493. <a href="https://doi.org/10.1101/gr.113985.110">https://doi.org/10.1101/gr.113985.110</a></p>
<p>Kimura M. (1977). <strong>Preponderance of synonymous changes as evidence for the neutral theory of molecular evolution.</strong> <em>Nature</em>, <strong>267</strong>, 275-276.</p>
<p>Li W. H. (1993). <strong>Unbiased estimation of the rates of synonymous and nonsynonymous substitution.</strong> <em>Journal of Molecular Evolution</em>, <strong>36(1)</strong>, 96-99. <a href="https://doi.org/10.1007/bf02407308">https://doi.org/10.1007/bf02407308</a></p>
<p>Microsoft, and Weston S. (2020). <strong>foreach: Provides Foreach Looping Construct.</strong> <em>R package version</em>, 1.5.1. <a href="https://cran.r-project.org/web/packages/foreach/index.html">foreach</a></p>
<p>Mugal C. F., Wolf J. B. W., Kaj I. (2014). <strong>Why Time Matters: Codon Evolution and the Temproal Dynamics of dN/dS.</strong> <em>Molecular Biology and Evolution</em>, <strong>31(1)</strong>, 212-231.</p>
<p>Ooms J. (2019). <strong>curl: A Modern and Flexible Web Client for R.</strong> <em>R package version</em>, 4.3. <a href="https://cran.r-project.org/web/packages/curl/index.html">curl</a></p>
<p>Pagès H., Aboyoun P., Gentleman R., and DebRoy S. (2017). <strong>Biostrings: Efficient manipulation of biological strings.</strong> <em>R package version</em>, 2.56.0. <a href="http://bioconductor.org/packages/release/bioc/html/Biostrings.html">Biostrings</a></p>
<p>Revolution Analytics, and Weston S. (2020). <strong>doMC: Foreach Parallel Adaptor for ‘parallel’.</strong> <em>R package version</em>, 1.3.7. <a href="https://cran.r-project.org/web/packages/doMC/index.html">doMC</a></p>
<p>Rost B. (1999). <strong>Twilight zone of protein sequence alignments.</strong> <em>Protein Engineering</em>, <strong>12(2)</strong>, 85-94. <a href="https://doi.org/10.1093/protein/12.2.85">https://doi.org/10.1093/protein/12.2.85</a></p>
<p>Scott C. (2017). <strong>shmlast: an improved implementation of conditional reciprocal best hits with LAST and Python.</strong> <em>Journal of Open Source Software</em>, <strong>2(9)</strong>, 142. <a href="https://joss.theoj.org/papers/10.21105/joss.00142">https://joss.theoj.org/papers/10.21105/joss.00142</a></p>
<p>Scrucca L., Fop M., Murphy T. B., and Raftery A. E. (2016) <strong>mclust 5: clustering, classification and density estimation using Gaussian finite mixture models.</strong> <em>The R Journal</em>, 8(1), 289-317. <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5096736/">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5096736/</a></p>
<p>Wickham H. (2011). <strong>testthat: Get Started with Testing.</strong> <em>The R Journal</em>, 3(1), 5. <a href="https://cran.r-project.org/web/packages/testthat/index.html">testthat</a></p>
<p>Wickham H. (2019). <strong>stringr: Simple, Consistent Wrappers for Common String Operations.</strong> <em>R package version</em>, 1.4.0. <a href="https://cran.r-project.org/web/packages/stringr/index.html">stringr</a></p>
<p>Wickham H. (2020). <strong>tidyr: Tidy Messy Data.</strong> <em>R package version</em>, 1.1.2. <a href="https://cran.r-project.org/web/packages/tidyr/index.html">tidyr</a></p>
<p>Wickham H., Hester J., and Chang W. (2020). <strong>devtools: Tools to make Developing R Packages Easier.</strong> <em>R package version</em>, (2.3.2). <a href="https://cran.r-project.org/web/packages/devtools/index.html">devtools</a></p>
<p>Wickham H., François R., Henry L., and Müller K. (2020). <strong>dplyr: A Grammar of Data Manipulation.</strong> <em>R package version</em>, 1.0.2. <a href="https://cran.r-project.org/web/packages/dplyr/index.html">dplyr</a></p>
<p>Yang Z., and Nielsen R. (2000). <strong>Estimating synonymous and nonsynonymous substitution rates under realistic evolutionary models.</strong> <em>Molecular Biology and Evolution</em>, <strong>17(1)</strong>, 32-43. <a href="https://doi.org/10.1093/oxfordjournals.molbev.a026236">https://doi.org/10.1093/oxfordjournals.molbev.a026236</a></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kristian K Ullrich.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
